===============================================================================
PX4 SAMV71-XULT CHANGES - QUICK SUMMARY
===============================================================================
Date: November 18, 2025
Purpose: LittleFS parameter storage on internal flash

FILES CREATED:
==============
1. /media/bhanu1234/Development/PX4-Autopilot-Private/CLAUDE_CHANGES_DOCUMENTATION.md
   → Full technical documentation (13KB)

2. /media/bhanu1234/Development/PX4-Autopilot-Private/CLAUDE_CHANGES.patch
   → Git diff of all changes (36KB, 1223 lines)

3. This file (CLAUDE_CHANGES_SUMMARY.txt)
   → Quick reference guide

HOW TO APPLY CHANGES:
====================
cd /media/bhanu1234/Development/PX4-Autopilot-Private
git apply CLAUDE_CHANGES.patch

HOW TO REVERT CHANGES:
=====================
cd /media/bhanu1234/Development/PX4-Autopilot-Private
git checkout .

MAIN CHANGES:
=============
1. Created littlefs_mount system command
   - src/systemcmds/littlefs_mount/

2. Added MTD flash partition (32KB at end of 2MB flash)
   - boards/microchip/samv71-xult-clickboards/src/init.c

3. NSH-compatible startup script
   - boards/microchip/samv71-xult-clickboards/init/rc.board_defaults

4. Dataman path override
   - ROMFS/px4fmu_common/init.d/rcS

5. Build system integration
   - boards/microchip/samv71-xult-clickboards/default.px4board
   - boards/microchip/samv71-xult-clickboards/nuttx-config/nsh/defconfig

CURRENT STATUS:
===============
✅ LittleFS mounts successfully on /fs/mtd_params
✅ Dataman uses correct path (/fs/mtd_params/dataman)
✅ NSH shell works without errors
❌ Flash partition too small (32KB, needs 68KB+ for dataman)

NEXT STEPS:
===========
Option A: Increase flash partition to 128KB
Option B: Switch to SD card implementation (RECOMMENDED)

For SD card implementation:
1. Enable CONFIG_SAMV7_HSMCI0 in defconfig
2. Add SD init code in board_app_initialize()
3. Remove DATAMAN_OPT override
4. Use /fs/microsd for storage

BUILD COMMAND:
==============
make microchip_samv71-xult-clickboards_default

FLASH COMMAND:
==============
openocd -f platforms/nuttx/NuttX/nuttx/boards/arm/samv7/common/tools/atmel-samv71-xult.cfg \
  -c "program build/microchip_samv71-xult-clickboards_default/microchip_samv71-xult-clickboards_default.elf verify reset exit"

KEY TECHNICAL NOTES:
====================
- NSH doesn't support: test/[ ], 2>&1, complex if/else
- Must use /dev/mtdblock0 for LittleFS (not /dev/mtdparams)
- DATAMAN_OPT variable set in rc.board_defaults, used in rcS
- Flash partition at 0x5f8000-0x600000 (physical addresses)

CONTACT:
========
For questions about these changes, refer to:
- Full documentation: CLAUDE_CHANGES_DOCUMENTATION.md
- Patch file: CLAUDE_CHANGES.patch

===============================================================================
